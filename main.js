let DATA_movies = {
  "detective": [
    {
      "name": "Достать ножи",
      "country": "США, 2019",
      "genre": "Детектив, Комедия, Драма, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 8.0"
        }
      ],
      "url": "'url('/img/getTheKnives.jpeg')'"
    },
    {
      "name": "Черный ящик",
      "country": "Франция, 2020",
      "genre": "Детектив, Триллер",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/blackBox.jpeg')"
    },
    {
      "name": "Девушка с татуировкой дракона ",
      "country": "США, Швеция, Норвегия 2011",
      "genre": "Детектив, Триллер, Драма, Криминал",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.7"
        }
      ],
      "url": "url('/img/girl.jpeg')"
    },
    {
      "name": "Бэтмен",
      "country": "США, 2022",
      "genre": "Детектив, Криминал, Драма, Боевик",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 7.9"
        }
      ],
      "url": "url('/img/batman.jpeg')"
    }
  ],
  "fantasy": [
    {
      "name": "Аватар",
      "country": "США, 2009",
      "genre": "Фантастика, Боевик, Драма, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.8",
          "Kinopoisk": "Кинопоиск: 8.0"
        }
      ],
      "url": "url('/img/avatar.jpeg')"
    },
    {
      "name": "Начало",
      "country": "США, Великобритания, 2010",
      "genre": "Фантастика, Боевик, Триллер, Детектив",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 8.8",
          "Kinopoisk": "Кинопоиск: 8.7"
        }
      ],
      "url": "url('/img/inception.jpeg')"
    },
    {
      "name": "Интерстеллар",
      "country": "США, Великобритания, Канада, 2014",
      "genre": "Фантастика, Драма, Приключения",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.6",
          "Kinopoisk": "Кинопоиск: 8.6"
        }
      ],
      "url": "url('/img/Interstellar.jpeg')"
    }
  ],
  "action": [
    {
      "name": "Гнев человеческий",
      "country": "Великобритания, США, 2021",
      "genre": "Боевик, Триллер",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/wrathOfMan.jpeg')"
    },
    {
      "name": "Брат 2",
      "country": "Россия, США, 2000",
      "genre": "Боевик, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.8",
          "Kinopoisk": "Кинопоиск: 8.2"
        }
      ],
      "url": "url('/img/brother.jpeg')"
    },
    {
      "name": "Шерлок Холмс",
      "country": "США, 2022",
      "genre": "Боевик, Приключения, Триллер, Комедия",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 8.1"
        }
      ],
      "url": "url('/img/SherlockHolmes.jpeg')"
    }
  ],
  "forKids": [
    {
      "name": "Один дома",
      "country": "США, 1990",
      "genre": "Комедия, Семейный",
      "agelimit": "0+",
      "rating": [
        {
          "IMBd": "IMDb: 7.7",
          "Kinopoisk": "Кинопоиск: 8.3"
        }
      ],
      "url": "url('/img/HomeAlone.jpeg')"
    },
    {
      "name": "Назад в будущее",
      "country": "США, 1985",
      "genre": "Фантастика, Комедия, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 8.5",
          "Kinopoisk": "Кинопоиск: 8.6"
        }
      ],
      "url": "url('/img/BackToTheFuture.jpeg')"
    },
    {
      "name": "Гарри Поттер и философский камень",
      "country": "США, Великобритания, 2001",
      "genre": "Фэнтези, Приключения, Семейный",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.3",
          "Kinopoisk": "Кинопоиск: 8.2"
        }
      ],
      "url": "url('/img/HarryPotter.jpeg')"
    }
  ],
  "comedy": [
    {
      "name": "Круэлла",
      "country": "США, Великобритания, 2021",
      "genre": "Комедия, Криминал, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.3",
          "Kinopoisk": "Кинопоиск: 7.5"
        }
      ],
      "url": "url('/img/Cruella.jpeg')"
    },
    {
      "name": "Отель Гранд Будапешт",
      "country": "США, Германия, 2014",
      "genre": "Комедия, Приключения, Детектив, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.4",
          "Kinopoisk": "Кинопоиск: 7.9"
        }
      ],
      "url": "url('/img/TheGrandBudapestHotel.jpeg')"
    },
    {
      "name": "Лулу и Бриггс",
      "country": "США, 2021",
      "genre": "Комедия, Драма, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 6.5",
          "Kinopoisk": "Кинопоиск: 7.4"
        }
      ],
      "url": "url('/img/Dog.jpeg')"
    }
  ],
  "melodrama": [
    {
      "name": "Титаник",
      "country": "США, Мексика, 1997",
      "genre": "Мелодрама, История, Триллер, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 8.4"
        }
      ],
      "url": "url('/img/Titanic.jpeg')"
    },
    {
      "name": "Стажёр",
      "country": "США, 2015",
      "genre": "Мелодрама, Комедия",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/TheIntern.jpeg')"
    },
    {
      "name": "Укрощение строптивого",
      "country": "Италия, 1980",
      "genre": "Мелодрама, Комедия",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 8.4"
        }
      ],
      "url": "url('/img/IlBisbeticoDomato.jpeg')"
    }
  ],
  "adventure": [
    {
      "name": "Выживший",
      "country": "США, Гонконг, Тайвань, 2015",
      "genre": "Приключения, Вестерн, Боевик, Драма, Биография",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 8.0",
          "Kinopoisk": "Кинопоиск: 7.8"
        }
      ],
      "url": "url('/img/TheRevenant.jpeg')"
    },
    {
      "name": "Парк Юрского периода",
      "country": "США, 1993",
      "genre": "Приключения, Фантастика, Семейный",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.2",
          "Kinopoisk": "Кинопоиск: 7.8"
        }
      ],
      "url": "url('/img/JurassicPark.jpeg')"
    },
    {
      "name": "Восточный ветер",
      "country": "США, 2013",
      "genre": "Приключения, Семейный, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 6.7",
          "Kinopoisk": "Кинопоиск: 8.1"
        }
      ],
      "url": "url('/img/Ostwind.jpeg')"
    }
  ]

}

let DATA_genre = {
  "detective": "Детектив",
  "fantasy": "Фантастика",
  "action": "Боевик",
  "forKids": "Для детей",
  "comedy": "Комедия",
  "melodrama": "Мелодрама",
  "adventure": "Приключения"
}

let movies_div_contener = document.getElementById('movies')
let categories_div_container = document.getElementById('categories')
let bodyy = document.getElementsByClassName('body');

//получаем фокус
document.addEventListener('keydown',handleInputFocusTransfer);
function handleInputFocusTransfer(e){
  const focusableInputElements = document.getElementsByTagName("*");
  // Создание массива из списка узлов
  const focusable= [...focusableInputElements]; 
  //получаем индекс текущего элемента
  const index = focusable.indexOf(document.activeElement); 
  // Создаем переменную для хранения индекса следующего элемента, который будет сфокусирован
  let nextIndex = 0;
  if (e.keyCode === 38) {
    // up arrow
    e.preventDefault();
    nextIndex= index > 0 ? index-1 : 0;
    focusableInputElements[nextIndex].focus();
    focusableInputElements[nextIndex].click();
  }
  else if (e.keyCode === 40) {
    // down arrow
    e.preventDefault();
    nextIndex= index+1 < focusable.length ? index+1 : index;
    focusableInputElements[nextIndex].focus();
    focusableInputElements[nextIndex].click();
  }
}

function set_descripltion_film() {
  movies_div_contener.innerHTML = '';
  let tab_name_movies = document.createElement('div');
  let main_movies = document.createElement('div');

  for (let genre_name in DATA_movies) {
    let tab_descr_movies = document.createElement('div');

    // создаем контейнер с описанием фильма - создали
    for (let film_info in DATA_movies[genre_name]) {
      let film_name = document.createElement('input');
      tab_name_movies.appendChild(film_name).type = 'button';
      film_name.id = `file_name_${film_info}`;
      film_name.classList.add('btn_categories');//надо удалить наверное
      film_name.style.backgroundImage = DATA_movies[genre_name][film_info].url;

      film_name.onclick = function () {
        let inner__list = document.createElement('ul');
        let h2 = document.createElement('h2');
        let li_1 = document.createElement('li');
        let li_2 = document.createElement('li');
        let li_3 = document.createElement('li');
        let li_4 = document.createElement('li');
        let li_5 = document.createElement('li');

        h2.innerHTML = DATA_movies[genre_name][film_info].name;
        tab_descr_movies.appendChild(h2).classList.add('inner__title');

        li_1.innerHTML = DATA_movies[genre_name][film_info].country;
        li_2.innerHTML = DATA_movies[genre_name][film_info].genre;
        li_3.innerHTML = DATA_movies[genre_name][film_info].agelimit;
        inner__list.appendChild(li_1).classList.add('inner__item');
        inner__list.appendChild(li_2).classList.add('inner__item');
        inner__list.appendChild(li_3).classList.add('inner__item', 'ageLimit');

        for (let j in DATA_movies[genre_name][film_info].rating) {
          li_4.innerHTML = DATA_movies[genre_name][film_info].rating[j].IMBd;
          li_5.innerHTML = DATA_movies[genre_name][film_info].rating[j].Kinopoisk;
          inner__list.appendChild(li_4).classList.add('inner__item', 'rating');
          inner__list.appendChild(li_5).classList.add('inner__item', 'rating');
        }
        tab_descr_movies.appendChild(inner__list).classList.add('inner__list', 'list-reset');

        //ЕНТО ПОКА НЕ РАБОТАЕТ ПОЧЕМУ-ТО
        let ReplaceBackground = function () {
          bodyy.style.backgroundImage = DATA_movies[genre_name][film_info].url;

        }
        document.addEventListener("DOMContentLoaded", ReplaceBackground);
      }

      main_movies.appendChild(tab_descr_movies).id = 'tab_descr_movies';
    }

  }
  movies_div_contener.appendChild(main_movies).id = 'main_movies';
  movies_div_contener.appendChild(tab_name_movies).id = 'tab_name_movies';
}

function set_categories() {
  categories_div_container.innerHTML = '';

  for (let genre_name in DATA_genre) {
    let btn = document.createElement('button');
    btn.innerHTML = DATA_genre[genre_name];
    btn.id = `btn_${genre_name}`;
    btn.classList.add('btn_categories');

    btn.onclick = function () {
      //делаем кнопку активной по нажатию
      let items_cat_active = document.querySelectorAll('.btn_categories-active');
      if (items_cat_active.length > 0) {
        for (let i = 0; i < items_cat_active.length; i++) {
          items_cat_active[i].classList.remove('btn_categories-active');
        }
      }
      btn.classList.add('btn_categories-active');

      // заполнение  div movies
      set_descripltion_film();
    }
    categories_div_container.appendChild(btn);
    //делаем кнопку активной после загрузки
    if (btn.id === 'btn_detective') {
      btn.click();
      btn.classList.add('btn_categories-active');
    }
  }

}

set_categories();



// preloader
window.onload = function () {
  document.body.classList.add('loaded__hiding');
  window.setTimeout(function () {
    document.body.classList.add('loaded');
    document.body.classList.remove('loaded__hiding');
  }, 500);
}