let DataMovies = {
  "detective": [
    {
      "name": "Достать ножи",
      "country": "США, 2019",
      "genre": "Детектив, Комедия, Драма, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 8.0"
        }
      ],
      "url": "url('/img/getTheKnives.jpeg')"
    },
    {
      "name": "Черный ящик",
      "country": "Франция, 2020",
      "genre": "Детектив, Триллер",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/blackBox.jpeg')"
    },
    {
      "name": "Девушка с татуировкой дракона ",
      "country": "США, Швеция, Норвегия 2011",
      "genre": "Детектив, Триллер, Драма, Криминал",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.7"
        }
      ],
      "url": "url('/img/girl.jpeg')"
    },
    {
      "name": "Бэтмен",
      "country": "США, 2022",
      "genre": "Детектив, Криминал, Драма, Боевик",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 7.9"
        }
      ],
      "url": "url('/img/batman.jpeg')"
    }
  ],
  "fantasy": [
    {
      "name": "Аватар",
      "country": "США, 2009",
      "genre": "Фантастика, Боевик, Драма, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.8",
          "Kinopoisk": "Кинопоиск: 8.0"
        }
      ],
      "url": "url('/img/avatar.jpeg')"
    },
    {
      "name": "Начало",
      "country": "США, Великобритания, 2010",
      "genre": "Фантастика, Боевик, Триллер, Детектив",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 8.8",
          "Kinopoisk": "Кинопоиск: 8.7"
        }
      ],
      "url": "url('/img/inception.jpeg')"
    },
    {
      "name": "Интерстеллар",
      "country": "США, Великобритания, Канада, 2014",
      "genre": "Фантастика, Драма, Приключения",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.6",
          "Kinopoisk": "Кинопоиск: 8.6"
        }
      ],
      "url": "url('/img/Interstellar.jpeg')"
    }
  ],
  "action": [
    {
      "name": "Гнев человеческий",
      "country": "Великобритания, США, 2021",
      "genre": "Боевик, Триллер",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/wrathOfMan.jpeg')"
    },
    {
      "name": "Брат 2",
      "country": "Россия, США, 2000",
      "genre": "Боевик, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.8",
          "Kinopoisk": "Кинопоиск: 8.2"
        }
      ],
      "url": "url('/img/brother.jpeg')"
    },
    {
      "name": "Шерлок Холмс",
      "country": "США, 2022",
      "genre": "Боевик, Приключения, Триллер, Комедия",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 8.1"
        }
      ],
      "url": "url('/img/SherlockHolmes.jpeg')"
    }
  ],
  "forKids": [
    {
      "name": "Один дома",
      "country": "США, 1990",
      "genre": "Комедия, Семейный",
      "agelimit": "0+",
      "rating": [
        {
          "IMBd": "IMDb: 7.7",
          "Kinopoisk": "Кинопоиск: 8.3"
        }
      ],
      "url": "url('/img/HomeAlone.jpeg')"
    },
    {
      "name": "Назад в будущее",
      "country": "США, 1985",
      "genre": "Фантастика, Комедия, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 8.5",
          "Kinopoisk": "Кинопоиск: 8.6"
        }
      ],
      "url": "url('/img/BackToTheFuture.jpeg')"
    },
    {
      "name": "Гарри Поттер и философский камень",
      "country": "США, Великобритания, 2001",
      "genre": "Фэнтези, Приключения, Семейный",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.3",
          "Kinopoisk": "Кинопоиск: 8.2"
        }
      ],
      "url": "url('/img/HarryPotter.jpeg')"
    }
  ],
  "comedy": [
    {
      "name": "Круэлла",
      "country": "США, Великобритания, 2021",
      "genre": "Комедия, Криминал, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.3",
          "Kinopoisk": "Кинопоиск: 7.5"
        }
      ],
      "url": "url('/img/Cruella.jpeg')"
    },
    {
      "name": "Отель Гранд Будапешт",
      "country": "США, Германия, 2014",
      "genre": "Комедия, Приключения, Детектив, Криминал",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.4",
          "Kinopoisk": "Кинопоиск: 7.9"
        }
      ],
      "url": "url('/img/TheGrandBudapestHotel.jpeg')"
    },
    {
      "name": "Лулу и Бриггс",
      "country": "США, 2021",
      "genre": "Комедия, Драма, Приключения",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 6.5",
          "Kinopoisk": "Кинопоиск: 7.4"
        }
      ],
      "url": "url('/img/Dog.jpeg')"
    }
  ],
  "melodrama": [
    {
      "name": "Титаник",
      "country": "США, Мексика, 1997",
      "genre": "Мелодрама, История, Триллер, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.9",
          "Kinopoisk": "Кинопоиск: 8.4"
        }
      ],
      "url": "url('/img/Titanic.jpeg')"
    },
    {
      "name": "Стажёр",
      "country": "США, 2015",
      "genre": "Мелодрама, Комедия",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 7.1",
          "Kinopoisk": "Кинопоиск: 7.6"
        }
      ],
      "url": "url('/img/TheIntern.jpeg')"
    },
    {
      "name": "Укрощение строптивого",
      "country": "Италия, 1980",
      "genre": "Мелодрама, Комедия",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 7.6",
          "Kinopoisk": "Кинопоиск: 8.4"
        }
      ],
      "url": "url('/img/IlBisbeticoDomato.jpeg')"
    }
  ],
  "adventure": [
    {
      "name": "Выживший",
      "country": "США, Гонконг, Тайвань, 2015",
      "genre": "Приключения, Вестерн, Боевик, Драма, Биография",
      "agelimit": "18+",
      "rating": [
        {
          "IMBd": "IMDb: 8.0",
          "Kinopoisk": "Кинопоиск: 7.8"
        }
      ],
      "url": "url('/img/TheRevenant.jpeg')"
    },
    {
      "name": "Парк Юрского периода",
      "country": "США, 1993",
      "genre": "Приключения, Фантастика, Семейный",
      "agelimit": "16+",
      "rating": [
        {
          "IMBd": "IMDb: 8.2",
          "Kinopoisk": "Кинопоиск: 7.8"
        }
      ],
      "url": "url('/img/JurassicPark.jpeg')"
    },
    {
      "name": "Восточный ветер",
      "country": "США, 2013",
      "genre": "Приключения, Семейный, Драма",
      "agelimit": "12+",
      "rating": [
        {
          "IMBd": "IMDb: 6.7",
          "Kinopoisk": "Кинопоиск: 8.1"
        }
      ],
      "url": "url('/img/Ostwind.jpeg')"
    }
  ]

}

let DataGenre = {
  "detective": "Детектив",
  "fantasy": "Фантастика",
  "action": "Боевик",
  "forKids": "Для детей",
  "comedy": "Комедия",
  "melodrama": "Мелодрама",
  "adventure": "Приключения"
}

var moviesDivContener = document.getElementById('movies')
var categoriesDivContainer = document.getElementById('categories');

document.addEventListener('keydown', changeFocus);
function changeFocus(e) {
  var focusableElements = document.getElementsByClassName('header__item');

  var arrayFocusableElem = [];

  for (var i of focusableElements) {
    arrayFocusableElem.push(i);
  }

  var index = arrayFocusableElem.indexOf(document.activeElement);
  var nextIndex = 0;
  //влево
  if (e.keyCode === 37) {
    nextIndex = index > 0 ? index - 1 : 0;
    focusableElements[nextIndex].focus();
    focusableElements[nextIndex].click();
  }
  //вправо
  if (e.keyCode === 39) {
    nextIndex = index > 0 ? index + 1 : index;
    focusableElements[nextIndex].focus();
    focusableElements[nextIndex].click();
  }

  //вверх
  if (e.keyCode === 38) {
    console.log('вверх');
    // nextIndex = index < 0 ? index + 2 : index;
    // focusableElements[nextIndex].focus();
    // focusableElements[nextIndex].click();
  }

  //вниз
  if (e.keyCode === 40) {
    console.log('вниз');
    // nextIndex = index > 0 ? index - 1 : 0;
    // focusableElements[nextIndex].focus();
    // focusableElements[nextIndex].click();
  }
}

//функция заполнения описания фильмов
function setDescripltionFilm(genreName) {
  moviesDivContener.innerHTML = '';
  let tabNameMovies = document.createElement('div');
  let test = document.createElement('div');
  let mainMovies = document.createElement('div');
  let tabDescrMovies = document.createElement('div');

  // контейнер с описанием фильма 
  for (let filmInfo in DataMovies[genreName]) {
    let filmName = document.createElement('input');
    tabNameMovies.appendChild(filmName).type = 'button';
    filmName.id = `film_name_${filmInfo}`;
    filmName.classList.add('btn_movies');
    filmName.style.backgroundImage = DataMovies[genreName][filmInfo].url;

    filmName.onclick = function () {
      filmName.style.backgroundRepeat = 'no-repeat';
      let itemsMoviesActive = document.querySelectorAll('.btn_movies-active');
      if (itemsMoviesActive.length > 0) {
        for (let i = 0; i < itemsMoviesActive.length; i++) {
          itemsMoviesActive[i].classList.remove('btn_movies-active');
        }
      }
      filmName.classList.add('btn_movies-active');

      document.body.style.backgroundImage = DataMovies[genreName][filmInfo].url;

      tabDescrMovies.innerHTML = ''
      let innerList = document.createElement('ul');
      let innerTitle = document.createElement('h2');
      let filmInfoCountry = document.createElement('li');
      let filmInfoGenre = document.createElement('li');
      let filmInfoAge = document.createElement('li');
      let filmInfoIBMd = document.createElement('li');
      let filmInfoKinopoisk = document.createElement('li');

      innerTitle.innerHTML = DataMovies[genreName][filmInfo].name;
      tabDescrMovies.appendChild(innerTitle).classList.add('inner__title');

      filmInfoCountry.innerHTML = DataMovies[genreName][filmInfo].country;
      filmInfoGenre.innerHTML = DataMovies[genreName][filmInfo].genre;
      filmInfoAge.innerHTML = DataMovies[genreName][filmInfo].agelimit;
      innerList.appendChild(filmInfoCountry).classList.add('inner__item');
      innerList.appendChild(filmInfoGenre).classList.add('inner__item');
      innerList.appendChild(filmInfoAge).classList.add('inner__item', 'ageLimit');

      for (let ratingInfo in DataMovies[genreName][filmInfo].rating) {
        filmInfoIBMd.innerHTML = DataMovies[genreName][filmInfo].rating[ratingInfo].IMBd;
        filmInfoKinopoisk.innerHTML = DataMovies[genreName][filmInfo].rating[ratingInfo].Kinopoisk;
        innerList.appendChild(filmInfoIBMd).classList.add('inner__item', 'rating');
        innerList.appendChild(filmInfoKinopoisk).classList.add('inner__item', 'rating');
      }
      tabDescrMovies.appendChild(innerList).classList.add('inner__list', 'list-reset');
    }
    mainMovies.appendChild(tabDescrMovies).id = 'tab_descr_movies';
    if (filmName.id === 'film_name_0') {
      filmName.click();
      filmName.classList.add('btn_movies-active');
    }
  }
  moviesDivContener.appendChild(test).id = 'test';
  test.appendChild(tabNameMovies).id = 'tabName_movies';

  moviesDivContener.appendChild(mainMovies).id = 'mainMovies';
}

// основная функция - заполенение категорий фильмов
function setCategories() {
  categoriesDivContainer.innerHTML = '';

  for (let genreName in DataGenre) {
    let btn = document.createElement('button');
    btn.innerHTML = DataGenre[genreName];
    btn.id = `btn_${genreName}`;
    btn.classList.add('btn_categories');

    btn.onclick = function () {
      //делаем кнопку активной по нажатию
      let itemsGenreActive = document.querySelectorAll('.btn_categories-active');
      if (itemsGenreActive.length > 0) {
        for (let i = 0; i < itemsGenreActive.length; i++) {
          itemsGenreActive[i].classList.remove('btn_categories-active');
        }
      }
      btn.classList.add('btn_categories-active');

      // заполнение  div movies
      setDescripltionFilm(genreName);
    }
    categoriesDivContainer.appendChild(btn);
    //делаем кнопку активной после загрузки
    if (btn.id === 'btn_detective') {
      btn.click();
      btn.classList.add('btn_categories-active');
    }
  }

}

setCategories();

window.onload = function () {
  document.body.classList.add('loaded__hiding');
  window.setTimeout(function () {
    document.body.classList.add('loaded');
    document.body.classList.remove('loaded__hiding');
  }, 500);
}